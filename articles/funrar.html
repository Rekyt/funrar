<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to funrar through an example • funrar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to funrar through an example">
<meta property="og:description" content="funrar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funrar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/funrar.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/new_distinctiveness.html">Alternative Distinctiveness definition</a>
    </li>
    <li>
      <a href="../articles/sparse_matrices.html">Sparse Matrices within funrar</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Rekyt/funrar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to funrar through an example</h1>
                        <h4 data-toc-skip class="author">Denelle Pierre &amp; Grenié Matthias</h4>
            
            <h4 data-toc-skip class="date">2022-09-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Rekyt/funrar/blob/HEAD/vignettes/funrar.Rmd" class="external-link"><code>vignettes/funrar.Rmd</code></a></small>
      <div class="hidden name"><code>funrar.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The idea of Functional Rarity is to measure two components of the rarity of a species (or an individual). In community ecology, researchers are generally interested in the rarity of a species as measured in terms of abundances. A species with a low abundance will be considered ‘rare’. From a functional ecology perspective, this omits important information about the “role” that a given species plays in the ecosystem, its particular niche. A framework is being developed of various indices to characterize how functioning can be rare locally or regionally</p>
<p>In their article, Violle et al. (2017) introduced 4 indices to compute functional rarity indices. <code>funrar</code> package enables ecologists to compute these on any dataset.</p>
</div>
<div class="section level2">
<h2 id="framework">Framework<a class="anchor" aria-label="anchor" href="#framework"></a>
</h2>
<p>The following figure show the 4 aspects covered by the metrics. Rarity is thus considered at local and regional scales and also from abundance and functional point of views. The name of the package functions are written underneath metrics’ names.</p>
<div class="figure">
<img src="figures/funrar_scheme.png" alt=""><p class="caption">Rarity indices and corresponding functions.</p>
</div>
</div>
<div class="section level2">
<h2 id="dataset-example">Dataset example<a class="anchor" aria-label="anchor" href="#dataset-example"></a>
</h2>
<p>To illustrate the package, we are using a dataset describing the distribution of 82 species of Alpine plants in 75 sites. This dataset was collected by Choler et al.(2005).</p>
<p>Species traits and environmental variables are also available.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"aravo"</span>, package <span class="op">=</span> <span class="st">"ade4"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">aravo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 4</span></span>
<span><span class="co">##  $ spe      :'data.frame':   75 obs. of  82 variables:</span></span>
<span><span class="co">##   ..$ Agro.rupe: int [1:75] 0 0 3 0 0 0 2 0 0 3 ...</span></span>
<span><span class="co">##   ..$ Alop.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Anth.nipp: int [1:75] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Heli.sede: int [1:75] 0 0 0 2 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Aven.vers: int [1:75] 0 0 1 0 0 0 2 0 1 2 ...</span></span>
<span><span class="co">##   ..$ Care.rosa: int [1:75] 1 2 2 2 0 3 2 2 3 3 ...</span></span>
<span><span class="co">##   ..$ Care.foet: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Care.parv: int [1:75] 0 1 0 0 0 1 1 1 1 0 ...</span></span>
<span><span class="co">##   ..$ Care.rupe: int [1:75] 3 0 0 0 0 1 0 3 0 0 ...</span></span>
<span><span class="co">##   ..$ Care.semp: int [1:75] 0 0 1 0 0 0 0 1 0 2 ...</span></span>
<span><span class="co">##   ..$ Fest.laev: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Fest.quad: int [1:75] 2 0 3 1 3 0 2 3 0 0 ...</span></span>
<span><span class="co">##   ..$ Fest.viol: int [1:75] 0 0 1 0 1 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Kobr.myos: int [1:75] 1 3 4 1 1 4 2 2 3 1 ...</span></span>
<span><span class="co">##   ..$ Luzu.lute: int [1:75] 0 0 1 0 0 0 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ Poa.alpi : int [1:75] 1 2 0 2 0 2 0 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Poa.supi : int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sesl.caer: int [1:75] 0 0 0 1 1 1 0 2 0 0 ...</span></span>
<span><span class="co">##   ..$ Alch.pent: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Alch.glau: int [1:75] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Alch.vulg: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Andr.brig: int [1:75] 0 0 0 0 0 0 0 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Ante.carp: int [1:75] 0 1 1 0 0 1 1 1 1 2 ...</span></span>
<span><span class="co">##   ..$ Ante.dioi: int [1:75] 0 0 0 0 0 0 0 1 0 0 ...</span></span>
<span><span class="co">##   ..$ Arni.mont: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Aste.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Bart.alpi: int [1:75] 0 1 0 0 0 1 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Camp.sche: int [1:75] 0 1 1 1 1 1 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Card.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Cera.stri: int [1:75] 0 0 0 0 0 1 0 0 1 0 ...</span></span>
<span><span class="co">##   ..$ Cera.cera: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Leuc.alpi: int [1:75] 0 0 0 0 0 0 1 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Cirs.acau: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Drab.aizo: int [1:75] 0 0 0 1 0 0 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Drya.octo: int [1:75] 0 1 0 0 0 1 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Erig.unif: int [1:75] 0 0 1 1 0 0 1 1 0 0 ...</span></span>
<span><span class="co">##   ..$ Gent.camp: int [1:75] 0 0 0 0 0 0 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Gent.acau: int [1:75] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Gent.vern: int [1:75] 0 0 1 1 1 0 0 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Geum.mont: int [1:75] 0 0 2 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Omal.supi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Andr.vita: int [1:75] 0 0 0 0 1 0 1 0 1 0 ...</span></span>
<span><span class="co">##   ..$ Hier.pili: int [1:75] 0 0 0 0 0 0 1 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Homo.alpi: int [1:75] 0 0 0 0 0 1 0 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Leon.pyre: int [1:75] 0 0 0 0 0 0 1 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Ligu.muto: int [1:75] 0 1 0 1 0 2 0 1 1 0 ...</span></span>
<span><span class="co">##   ..$ Lloy.sero: int [1:75] 0 1 0 0 0 1 1 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Minu.sedo: int [1:75] 1 0 0 0 0 0 1 1 2 1 ...</span></span>
<span><span class="co">##   ..$ Minu.vern: int [1:75] 1 0 1 1 1 0 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Phyt.orbi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Plan.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Poly.vivi: int [1:75] 1 1 1 0 1 1 1 1 1 0 ...</span></span>
<span><span class="co">##   ..$ Pote.aure: int [1:75] 0 0 2 0 0 0 1 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Pote.cran: int [1:75] 0 0 1 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">##   ..$ Pote.gran: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Puls.vern: int [1:75] 0 0 2 0 0 0 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ Ranu.kuep: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sagi.glab: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sali.herb: int [1:75] 0 0 0 0 0 0 1 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sali.reti: int [1:75] 0 1 0 0 0 2 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sali.retu: int [1:75] 0 2 0 0 0 2 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sali.serp: int [1:75] 0 1 0 0 0 0 0 0 2 0 ...</span></span>
<span><span class="co">##   ..$ Saxi.pani: int [1:75] 1 0 0 2 1 1 0 1 1 1 ...</span></span>
<span><span class="co">##   ..$ Sedu.alpe: int [1:75] 0 0 0 0 0 0 0 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Semp.mont: int [1:75] 0 1 1 1 0 1 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Sene.inca: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Sibb.proc: int [1:75] 0 0 0 0 0 0 1 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Sile.acau: int [1:75] 1 1 1 0 0 2 1 0 1 0 ...</span></span>
<span><span class="co">##   ..$ Thym.poly: int [1:75] 0 0 0 2 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Vero.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Vero.alli: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Vero.bell: int [1:75] 0 0 0 1 0 1 1 0 1 1 ...</span></span>
<span><span class="co">##   ..$ Myos.alpe: int [1:75] 0 0 1 1 0 0 1 0 0 1 ...</span></span>
<span><span class="co">##   ..$ Tara.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Scab.luci: int [1:75] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Anth.alpe: int [1:75] 0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Oxyt.camp: int [1:75] 1 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Oxyt.lapp: int [1:75] 1 1 0 1 1 1 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Lotu.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Trif.alpi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Trif.badi: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ Trif.thal: int [1:75] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ env      :'data.frame':   75 obs. of  6 variables:</span></span>
<span><span class="co">##   ..$ Aspect: int [1:75] 7 1 5 9 9 1 5 6 9 1 ...</span></span>
<span><span class="co">##   ..$ Slope : int [1:75] 2 35 0 30 5 30 10 12 2 5 ...</span></span>
<span><span class="co">##   ..$ Form  : Factor w/ 5 levels "1","2","3","4",..: 1 3 3 3 1 3 3 2 1 3 ...</span></span>
<span><span class="co">##   ..$ PhysD : int [1:75] 50 40 20 80 80 40 70 15 65 60 ...</span></span>
<span><span class="co">##   ..$ ZoogD : Factor w/ 3 levels "no","some","high": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ Snow  : int [1:75] 140 140 140 140 140 140 160 140 140 150 ...</span></span>
<span><span class="co">##  $ traits   :'data.frame':   82 obs. of  8 variables:</span></span>
<span><span class="co">##   ..$ Height: num [1:82] 6 5 15 0 12 30 12 25 9 20 ...</span></span>
<span><span class="co">##   ..$ Spread: int [1:82] 10 20 5 30 30 20 40 10 5 20 ...</span></span>
<span><span class="co">##   ..$ Angle : int [1:82] 80 20 50 80 60 80 45 80 70 50 ...</span></span>
<span><span class="co">##   ..$ Area  : num [1:82] 60 191 280 600 420 ...</span></span>
<span><span class="co">##   ..$ Thick : num [1:82] 0.12 0.2 0.08 0.2 0.14 0.4 0.14 0.2 0.2 0.2 ...</span></span>
<span><span class="co">##   ..$ SLA   : num [1:82] 8.1 15.1 18 10.6 12.5 6.5 19 13.7 8.8 11.5 ...</span></span>
<span><span class="co">##   ..$ N_mass: num [1:82] 219 204 220 233 156 ...</span></span>
<span><span class="co">##   ..$ Seed  : num [1:82] 0.08 0.21 0.54 1.72 1.17 1.68 0.23 0.61 0.64 0.83 ...</span></span>
<span><span class="co">##  $ spe.names: Named chr [1:82] "Agrostis rupestris All." "Alopecurus alpinus Vill." "Anthoxanthum odoratum L.  subsp. nipponicum (Honda) Tzvelev" "Helictotrichon sedenense (DC.) Holub" ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:82] "Agro.rupe" "Alop.alpi" "Anth.nipp" "Heli.sede" ...</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="functional-rarity-indices">Functional rarity indices<a class="anchor" aria-label="anchor" href="#functional-rarity-indices"></a>
</h2>
<div class="section level3">
<h3 id="inputs-of-functions">Inputs of functions<a class="anchor" aria-label="anchor" href="#inputs-of-functions"></a>
</h3>
<p>For each metric, the package includes two functions, depending on the input type. Ecologist usually have to deal with site-species matrix, containing sites names as rows, species in columns and either abundances or presence/absence data (see example datasets in <code>vegan</code> or <code>ade4</code> packages for example). Thus, this matrix is needed as an input for each simple function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Site-species matrix stored in aravo$spe</span></span>
<span><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">aravo</span><span class="op">$</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##      Agro.rupe Alop.alpi Anth.nipp Heli.sede Aven.vers</span></span>
<span><span class="co">## AR07         0         0         0         0         0</span></span>
<span><span class="co">## AR71         0         0         0         0         0</span></span>
<span><span class="co">## AR26         3         0         1         0         1</span></span>
<span><span class="co">## AR54         0         0         0         2         0</span></span>
<span><span class="co">## AR60         0         0         0         0         0</span></span></code></pre>
<p><code>metricname()</code> functions can be used to compute indices directly on site-species matrices.</p>
<p>Users can also use a stacked (or tidy) data.frame, containing columns for sites, species and abundances. The package contains for each metric another function called <code>metricname_stack()</code> function that can take these stacked data.frames as inputs.</p>
<p><code>funrar</code> package includes two functions to go from one format to the other: <code><a href="../reference/matrix_to_stack.html">matrix_to_stack()</a></code> and <code><a href="../reference/stack_to_matrix.html">stack_to_matrix()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rekyt.github.io/funrar/" class="external-link">funrar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="../reference/matrix_to_stack.html">matrix_to_stack</a></span><span class="op">(</span><span class="va">mat</span>, <span class="st">"value"</span>, <span class="st">"site"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species site value</span></span>
<span><span class="co">## 1 Agro.rupe AR07     0</span></span>
<span><span class="co">## 2 Agro.rupe AR71     0</span></span>
<span><span class="co">## 3 Agro.rupe AR26     3</span></span>
<span><span class="co">## 4 Agro.rupe AR54     0</span></span>
<span><span class="co">## 5 Agro.rupe AR60     0</span></span>
<span><span class="co">## 6 Agro.rupe AR70     0</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The reverse function is provided and gives the same original matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="../reference/stack_to_matrix.html">stack_to_matrix</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"site"</span>, <span class="st">"species"</span>, <span class="st">"value"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Removal of empty rows</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>The package is also able to deal with large matrices with many zeroes by using sparse matrices. For more details, see <code>sparse_matrices</code> vignette.</p>
</div>
<div class="section level3">
<h3 id="indices">Indices<a class="anchor" aria-label="anchor" href="#indices"></a>
</h3>
<div class="section level4">
<h4 id="distance-matrix-computation">Distance matrix computation<a class="anchor" aria-label="anchor" href="#distance-matrix-computation"></a>
</h4>
<p>The indices rely on the computation of a distance matrix. It represents the functional distance between two species given a particular set of traits. From a species traits matrix you can easily compute a distance matrix using function <code><a href="../reference/compute_dist_matrix.html">compute_dist_matrix()</a></code>.</p>
<p>In order to compute distance matrix, species names must be specified as <strong>rownames</strong> in the traits table. Further, species names must match between the traits table and distance matrix. Species names must be characters and not factors.</p>
<p>The function relies on the <code>daisy()</code> function from package <code>cluster</code> and the default metric is Gower’s distance to take into account ordinal, categorical and binary traits:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tra</span> <span class="op">=</span> <span class="va">aravo</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Height"</span>, <span class="st">"SLA"</span>, <span class="st">"N_mass"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           Height  SLA N_mass</span></span>
<span><span class="co">## Agro.rupe      6  8.1 218.70</span></span>
<span><span class="co">## Alop.alpi      5 15.1 203.85</span></span>
<span><span class="co">## Anth.nipp     15 18.0 219.60</span></span>
<span><span class="co">## Heli.sede      0 10.6 233.20</span></span>
<span><span class="co">## Aven.vers     12 12.5 156.25</span></span>
<span><span class="co">## Care.rosa     30  6.5 208.65</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_mat</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_dist_matrix.html">compute_dist_matrix</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Only numeric traits provided, consider using euclidean distance.</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           Agro.rupe Alop.alpi Anth.nipp Heli.sede Aven.vers</span></span>
<span><span class="co">## Agro.rupe 0.0000000 0.1004668 0.2083010 0.1068477 0.1705883</span></span>
<span><span class="co">## Alop.alpi 0.1004668 0.0000000 0.1567591 0.1308034 0.1488041</span></span>
<span><span class="co">## Anth.nipp 0.2083010 0.1567591 0.0000000 0.2592416 0.1500077</span></span>
<span><span class="co">## Heli.sede 0.1068477 0.1308034 0.2592416 0.0000000 0.2231472</span></span>
<span><span class="co">## Aven.vers 0.1705883 0.1488041 0.1500077 0.2231472 0.0000000</span></span></code></pre>
<p>Using the <code>metric</code> argument in <code><a href="../reference/compute_dist_matrix.html">compute_dist_matrix()</a></code> you can specify other distance metrics (<code>euclidean</code> for Euclidean distances and <code>manhattan</code> for Manhattan distances) for functional distances. You can also compute your own distance matrix with other methods as long as it is a matrix and both row names and column names are species names.</p>
</div>
<div class="section level4">
<h4 id="functional-distinctiveness-computation">Functional Distinctiveness computation<a class="anchor" aria-label="anchor" href="#functional-distinctiveness-computation"></a>
</h4>
<div class="section level5">
<h5 id="formula">Formula<a class="anchor" aria-label="anchor" href="#formula"></a>
</h5>
<p>The distinctiveness measures how a species is locally functionally rare, in comparison with the other species of community. Each species (or individual) in each community will get a distinctiveness value. Distinctiveness values range from 0 to 1. A value of 0 indicates that the focal species is not locally functionally distant from the other and conversely.</p>
<p>From given functional distances, it is computed as such: <span class="math display">\[
D_i = \frac{\sum_{\substack{j = 1, \\
                            i \neq j
                            }}^{N} d_{ij}}{N-1},
\]</span> with <span class="math inline">\(D_i\)</span> distinctiveness of species <span class="math inline">\(i\)</span>, <span class="math inline">\(d_{ij}\)</span> the functional distance between species <span class="math inline">\(i\)</span> and species <span class="math inline">\(j\)</span>, <span class="math inline">\(N\)</span> the number of species present in considered community.</p>
<p>When weighted by abundances the formula becomes: <span class="math display">\[
D_i = \frac{\sum_{\substack{j = 1, \\
                            i \neq j
                            }}^{N} d_{ij}\times A_j}{\sum_{\substack{j = 1, \\
                            i \neq j
                            }}^{N} A_j},
\]</span> with the same terms as above, and <span class="math inline">\(A_j\)</span> the relative abundance of species <span class="math inline">\(j\)</span> in percent, in the community.</p>
</div>
<div class="section level5">
<h5 id="computation-with-site-species-matrix">Computation with site-species matrix<a class="anchor" aria-label="anchor" href="#computation-with-site-species-matrix"></a>
</h5>
<p>Using <code>funrar</code> functional distinctiveness can be computed using function <code><a href="../reference/distinctiveness.html">distinctiveness()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute distinctiveness for each species on each site</span></span>
<span><span class="va">di</span> <span class="op">=</span> <span class="fu"><a href="../reference/distinctiveness.html">distinctiveness</a></span><span class="op">(</span>pres_matrix <span class="op">=</span> <span class="va">mat</span>,  <span class="co"># The site x species matrix</span></span>
<span>                     dist_matrix <span class="op">=</span> <span class="va">dist_mat</span><span class="op">)</span>  <span class="co"># Functional Distance matrix</span></span>
<span></span>
<span><span class="va">di</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##      Agro.rupe Alop.alpi Anth.nipp Heli.sede Aven.vers</span></span>
<span><span class="co">## AR07        NA        NA        NA        NA        NA</span></span>
<span><span class="co">## AR71        NA        NA        NA        NA        NA</span></span>
<span><span class="co">## AR26 0.1460428        NA 0.2039929        NA 0.1788624</span></span>
<span><span class="co">## AR54        NA        NA        NA 0.1786867        NA</span></span>
<span><span class="co">## AR60        NA        NA        NA        NA        NA</span></span></code></pre>
<p>The syntax for <code><a href="../reference/distinctiveness.html">distinctiveness()</a></code> is first the matrix and then the functional distance matrix. The function returns a site-species matrix filled with <code>Di</code> values, i.e. the species functional distinctiveness in each species per site combination.</p>
</div>
<div class="section level5">
<h5 id="computation-with-stacked-data-frame">Computation with stacked data.frame<a class="anchor" aria-label="anchor" href="#computation-with-stacked-data-frame"></a>
</h5>
<p>Using <code>funrar</code> distinctiveness values can be computed using function <code><a href="../reference/distinctiveness_stack.html">distinctiveness_stack()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species should be character</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute distinctiveness for each species on each site</span></span>
<span><span class="va">di_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/distinctiveness_stack.html">distinctiveness_stack</a></span><span class="op">(</span></span>
<span>  com_df <span class="op">=</span> <span class="va">dat</span>,  <span class="co"># The site x species table</span></span>
<span>  sp_col <span class="op">=</span> <span class="st">"species"</span>,  <span class="co"># Name of the species column</span></span>
<span>  com <span class="op">=</span> <span class="st">"site"</span>,  <span class="co"># Name of the community column</span></span>
<span>  abund <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Relative abundances column (facultative)</span></span>
<span>  dist_matrix <span class="op">=</span> <span class="va">dist_mat</span>  <span class="co"># Functional Distance matrix</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No abundance column provided, computing Di without it</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">di_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species site value        Di</span></span>
<span><span class="co">## 1 Agro.rupe AR01     1 0.1661127</span></span>
<span><span class="co">## 2 Heli.sede AR01     2 0.1828906</span></span>
<span><span class="co">## 3 Care.parv AR01     1 0.3057277</span></span>
<span><span class="co">## 4 Care.rupe AR01     3 0.1805076</span></span>
<span><span class="co">## 5 Fest.laev AR01     1 0.3093468</span></span>
<span><span class="co">## 6 Fest.viol AR01     1 0.1907347</span></span></code></pre>
<p>The syntax for <code><a href="../reference/distinctiveness_stack.html">distinctiveness_stack()</a></code> is first the table, then the name of the species column, then the name of the community column, then the name of the relative abundance column and finally the distance matrix. The function add a <code>Di</code> column giving the species distinctiveness in each species per site combination.</p>
<p>For abundance weighted distinctiveness you need to have a column containing relative abundances in your data frame as such:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/distinctiveness_stack.html">distinctiveness_stack</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"species"</span>, <span class="st">"site"</span>, <span class="st">"value"</span>, <span class="va">dist_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">di_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species site value        Di</span></span>
<span><span class="co">## 1 Agro.rupe AR01     1 0.1569403</span></span>
<span><span class="co">## 2 Heli.sede AR01     2 0.1924531</span></span>
<span><span class="co">## 3 Care.parv AR01     1 0.2837640</span></span>
<span><span class="co">## 4 Care.rupe AR01     3 0.1761766</span></span>
<span><span class="co">## 5 Fest.laev AR01     1 0.2828495</span></span>
<span><span class="co">## 6 Fest.viol AR01     1 0.1918732</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="scarcity">Scarcity<a class="anchor" aria-label="anchor" href="#scarcity"></a>
</h4>
<div class="section level5">
<h5 id="formula-1">Formula<a class="anchor" aria-label="anchor" href="#formula-1"></a>
</h5>
<p>The scarcity measures how locally abundant a species is, in comparison to the other species of community. Each species (or individual) in each community will get a scarcity value. Scarcity values range from 0 to 1. A 0 value indicates that the focal species is locally abundant and conversely.</p>
<p><span class="math display">\[
S_i = \exp(-NA_i\log2),
\]</span></p>
<p>with <span class="math inline">\(S_i\)</span> the scarcity of species <span class="math inline">\(i\)</span>, <span class="math inline">\(N\)</span> the number of species in the local community, <span class="math inline">\(A_i\)</span> the relative abundance (in percent) of species <span class="math inline">\(i\)</span> in the community.</p>
</div>
<div class="section level5">
<h5 id="computation">Computation<a class="anchor" aria-label="anchor" href="#computation"></a>
</h5>
<p>With <code>funrar</code> it can be computed with <code><a href="../reference/scarcity.html">scarcity()</a></code> function with a syntax analog to <code><a href="../reference/distinctiveness.html">distinctiveness()</a></code></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si</span> <span class="op">=</span> <span class="fu"><a href="../reference/scarcity.html">scarcity</a></span><span class="op">(</span>pres_matrix <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in scarcity(pres_matrix = mat): Provided object may not contain relative abundances nor presence-absence</span></span>
<span><span class="co">## Have a look at the make_relative() function if it is the case</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##         Agro.rupe Alop.alpi    Anth.nipp    Heli.sede    Aven.vers</span></span>
<span><span class="co">## AR07           NA        NA           NA           NA           NA</span></span>
<span><span class="co">## AR71           NA        NA           NA           NA           NA</span></span>
<span><span class="co">## AR26 3.308722e-24        NA 1.490116e-08           NA 1.490116e-08</span></span>
<span><span class="co">## AR54           NA        NA           NA 1.455192e-11           NA</span></span>
<span><span class="co">## AR60           NA        NA           NA           NA           NA</span></span></code></pre>
<p>Scarcity requires relative abundances to be computed. We thus have to convert our dataset with abundances to relative abundances. To do that we first compute total abundances per site.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute relative abundances</span></span>
<span><span class="va">site_abundances</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">site</span>, data <span class="op">=</span> <span class="va">dat</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">site_abundances</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="st">"total_abundance"</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">site_abundances</span>, by <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">rel_abund</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">dat</span><span class="op">[[</span><span class="st">"total_abundance"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   site   species value total_abundance rel_abund</span></span>
<span><span class="co">## 1 AR01 Oxyt.camp     1              32   0.03125</span></span>
<span><span class="co">## 2 AR01 Gent.vern     1              32   0.03125</span></span>
<span><span class="co">## 3 AR01 Fest.laev     1              32   0.03125</span></span>
<span><span class="co">## 4 AR01 Kobr.myos     5              32   0.15625</span></span>
<span><span class="co">## 5 AR01 Vero.bell     1              32   0.03125</span></span>
<span><span class="co">## 6 AR01 Care.rupe     3              32   0.09375</span></span></code></pre>
<p>Then we can compute Scarcity using relative abundances:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/scarcity_stack.html">scarcity_stack</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"species"</span>, <span class="st">"site"</span>, <span class="st">"rel_abund"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">si_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   site   species value total_abundance rel_abund         Si</span></span>
<span><span class="co">## 1 AR01 Oxyt.camp     1              32   0.03125 0.60762368</span></span>
<span><span class="co">## 2 AR01 Gent.vern     1              32   0.03125 0.60762368</span></span>
<span><span class="co">## 3 AR01 Fest.laev     1              32   0.03125 0.60762368</span></span>
<span><span class="co">## 4 AR01 Kobr.myos     5              32   0.15625 0.08282729</span></span>
<span><span class="co">## 5 AR01 Vero.bell     1              32   0.03125 0.60762368</span></span>
<span><span class="co">## 6 AR01 Care.rupe     3              32   0.09375 0.22433863</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="uniqueness">Uniqueness<a class="anchor" aria-label="anchor" href="#uniqueness"></a>
</h4>
<div class="section level5">
<h5 id="formula-2">Formula<a class="anchor" aria-label="anchor" href="#formula-2"></a>
</h5>
<p>Uniqueness measures how functionally rare a species is at the regional scale. Each species (or individual) in the species pool will get a uniqueness value. Uniqueness values range from 0 to 1. A 0 value indicates that the focal species shares the exact same traits as other species in the pool and conversely.</p>
<p><span class="math display">\[
U_i = \text{min}(d_{ij}), \forall j \in [1, N_R], j \neq i,
\]</span></p>
<p>with <span class="math inline">\(U_i\)</span> the uniqueness of species <span class="math inline">\(i\)</span>, <span class="math inline">\(d_{ij}\)</span> the functional distance between species <span class="math inline">\(i\)</span> and species <span class="math inline">\(j\)</span>, <span class="math inline">\(N_R\)</span> the number of species in the regional pool.</p>
</div>
<div class="section level5">
<h5 id="computation-1">Computation<a class="anchor" aria-label="anchor" href="#computation-1"></a>
</h5>
<p><code><a href="../reference/uniqueness.html">uniqueness()</a></code> follows a similar syntax, but beware that given community table and distance matrix should represent the <strong>regional species pool</strong>. And the syntax is also similar:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="../reference/uniqueness.html">uniqueness</a></span><span class="op">(</span><span class="va">mat</span>, <span class="va">dist_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ui</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species         Ui</span></span>
<span><span class="co">## 1 Agro.rupe 0.03635369</span></span>
<span><span class="co">## 2 Alop.alpi 0.03715692</span></span>
<span><span class="co">## 3 Anth.nipp 0.09414051</span></span>
<span><span class="co">## 4 Heli.sede 0.02270997</span></span>
<span><span class="co">## 5 Aven.vers 0.05675178</span></span>
<span><span class="co">## 6 Care.rosa 0.15922932</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/uniqueness_stack.html">uniqueness_stack</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"species"</span>, <span class="va">dist_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ui_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species         Ui</span></span>
<span><span class="co">## 1 Oxyt.camp 0.06768509</span></span>
<span><span class="co">## 2 Gent.vern 0.01736809</span></span>
<span><span class="co">## 3 Fest.laev 0.09332004</span></span>
<span><span class="co">## 4 Kobr.myos 0.10466645</span></span>
<span><span class="co">## 5 Vero.bell 0.04370376</span></span>
<span><span class="co">## 6 Care.rupe 0.01953443</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ui_df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">ui_df</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 82  2</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="geographical-restrictedness">Geographical Restrictedness<a class="anchor" aria-label="anchor" href="#geographical-restrictedness"></a>
</h4>
<div class="section level5">
<h5 id="formula-3">Formula<a class="anchor" aria-label="anchor" href="#formula-3"></a>
</h5>
<p>Restrictedness measures how regionally rare a species is. The following function represents a species’ occupancy for a set of communities. Each species (or individual) in the species pool will have a restrictedness value. Restrictedness values range from 0 to 1. A 0 value indicates that the focal species is present in all the sites.</p>
<p><span class="math display">\[
R_i = 1 - N_i/N_tot
\]</span></p>
<p>with <span class="math inline">\(R_i\)</span> the restrictedness of species <span class="math inline">\(i\)</span>, <span class="math inline">\(N_i\)</span> the number of sites where species <span class="math inline">\(i\)</span> is found and <span class="math inline">\(N_tot\)</span> the total number of sites.</p>
</div>
<div class="section level5">
<h5 id="computation-2">Computation<a class="anchor" aria-label="anchor" href="#computation-2"></a>
</h5>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ri</span> <span class="op">=</span> <span class="fu"><a href="../reference/restrictedness.html">restrictedness</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species        Ri</span></span>
<span><span class="co">## 1 Agro.rupe 0.6133333</span></span>
<span><span class="co">## 2 Alop.alpi 0.5066667</span></span>
<span><span class="co">## 3 Anth.nipp 0.7733333</span></span>
<span><span class="co">## 4 Heli.sede 0.9466667</span></span>
<span><span class="co">## 5 Aven.vers 0.8000000</span></span>
<span><span class="co">## 6 Care.rosa 0.6266667</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species should be character</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">site</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">site</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ri_df</span> <span class="op">=</span> <span class="fu"><a href="../reference/restrictedness_stack.html">restrictedness_stack</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"species"</span>, <span class="st">"site"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ri_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     species        Ri</span></span>
<span><span class="co">## 1 Agro.rupe 0.6133333</span></span>
<span><span class="co">## 2 Alch.glau 0.8133333</span></span>
<span><span class="co">## 3 Alch.pent 0.6533333</span></span>
<span><span class="co">## 4 Alch.vulg 0.9333333</span></span>
<span><span class="co">## 5 Alop.alpi 0.5066667</span></span>
<span><span class="co">## 6 Andr.brig 0.7733333</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="funrar">funrar<a class="anchor" aria-label="anchor" href="#funrar"></a>
</h4>
<p>This function computes all of the four metrics introduced above.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_ind</span> <span class="op">=</span> <span class="fu"><a href="../reference/funrar.html">funrar</a></span><span class="op">(</span><span class="va">mat</span>, <span class="va">dist_mat</span>, rel_abund <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in scarcity(pres_matrix): Provided object may not contain relative abundances nor presence-absence</span></span>
<span><span class="co">## Have a look at the make_relative() function if it is the case</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">all_ind</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 4</span></span>
<span><span class="co">##  $ Ui:'data.frame':  82 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ species: chr [1:82] "Agro.rupe" "Alop.alpi" "Anth.nipp" "Heli.sede" ...</span></span>
<span><span class="co">##   ..$ Ui     : num [1:82] 0.0364 0.0372 0.0941 0.0227 0.0568 ...</span></span>
<span><span class="co">##  $ Di: num [1:75, 1:82] NA NA 0.146 NA NA ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:75] "AR07" "AR71" "AR26" "AR54" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:82] "Agro.rupe" "Alop.alpi" "Anth.nipp" "Heli.sede" ...</span></span>
<span><span class="co">##  $ Ri:'data.frame':  82 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ species: chr [1:82] "Agro.rupe" "Alop.alpi" "Anth.nipp" "Heli.sede" ...</span></span>
<span><span class="co">##   ..$ Ri     : num [1:82] 0.613 0.507 0.773 0.947 0.8 ...</span></span>
<span><span class="co">##  $ Si: num [1:75, 1:82] NA NA 3.31e-24 NA NA ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:75] "AR07" "AR71" "AR26" "AR54" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:82] "Agro.rupe" "Alop.alpi" "Anth.nipp" "Heli.sede" ...</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">all_ind</span><span class="op">$</span><span class="va">Ui</span>, <span class="va">ui</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">all_ind</span><span class="op">$</span><span class="va">Di</span>, <span class="va">di</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">all_ind</span><span class="op">$</span><span class="va">Ri</span>, <span class="va">ri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">all_ind</span><span class="op">$</span><span class="va">Si</span>, <span class="va">si</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<p>In this section, some ideas to plot your results are presented. For example the density of the various indices or a matrix visualization of the values of distinctiveness per species.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heatmap with distinctiveness values</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">di_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Di</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="funrar_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Density of distinctiveness values</span></span>
<span></span>
<span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">di_df</span><span class="op">$</span><span class="va">Di</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">labels_quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">di_density</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">di_df</span><span class="op">$</span><span class="va">Di</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">di_density</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">di_density</span>, <span class="va">x</span> <span class="op">&gt;=</span> <span class="va">quant</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">quant</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">di_density</span><span class="op">$</span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">di_density</span><span class="op">$</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">quant</span><span class="op">)</span>   </span>
<span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">di_df</span><span class="op">$</span><span class="va">Di</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">labels_quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">di_dens</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">di_density</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">quant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlBu"</span>, labels <span class="op">=</span> <span class="va">labels_quant</span>,</span>
<span>                    name <span class="op">=</span> <span class="st">"Quantile"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Distinctiveness values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density of distinctiveness values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">di_dens</span></span></code></pre></div>
<p><img src="funrar_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Density of scarcity values</span></span>
<span></span>
<span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">si_df</span><span class="op">$</span><span class="va">Si</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">labels_quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">si_density</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">si_df</span><span class="op">$</span><span class="va">Si</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">si_density</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">si_density</span>, <span class="va">x</span> <span class="op">&gt;=</span> <span class="va">quant</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">quant</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">si_density</span><span class="op">$</span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">si_density</span><span class="op">$</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">quant</span><span class="op">)</span>   </span>
<span><span class="va">quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">si_df</span><span class="op">$</span><span class="va">Si</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">labels_quant</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">si_dens</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">si_density</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">quant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlBu"</span>, labels <span class="op">=</span> <span class="va">labels_quant</span>,</span>
<span>                    name <span class="op">=</span> <span class="st">"Quantile"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Scarcity values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density of scarcity values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">si_dens</span></span></code></pre></div>
<p><img src="funrar_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regional rarity: restrictedness versus uniqueness</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ri_df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ri_df</span><span class="op">)</span> <span class="op">==</span> <span class="st">"sp"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"species"</span></span>
<span><span class="va">ri_ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">ri_df</span>, <span class="va">ui_df</span>, by <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ri_ui</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Ri</span>, <span class="va">Ui</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="funrar_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Choler, P. (2005) Consistent shifts in Alpine plant traits along a mesotopographical gradient. Arctic, Antarctic, and Alpine Research, 37,444-453.</p>
<p>Violle C., Thuiller W., Mouquet N., Munoz F., Kraft NJB, Cadotte MW, Livingstone SW, Mouillot D., Functional Rarity: The Ecology of Outliers, <em>Trends in Ecology &amp; Evolution</em>, Volume 32, Issue 5, May 2017, Pages 356-367, ISSN 0169-5347, <a href="https://doi.org/10.1016/j.tree.2017.02.002" class="external-link uri">https://doi.org/10.1016/j.tree.2017.02.002</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matthias Grenié, Pierre Denelle, Caroline Tucker.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
